<script>
(function(){
  const path = window.location.pathname.replace(/\/$/, '');
  if (path !== '/blogroll') return; // only run on your /blogroll page

  document.addEventListener('DOMContentLoaded', async function(){
    const el = document.getElementById('feed-list');
    if (!el) return;

    const opmlUrl = "https://raw.githubusercontent.com/folkmoss/bbstuff/main/feeds.opml";

    try {
      const r = await fetch(opmlUrl);
      if (!r.ok) throw new Error("Fetch failed: " + r.status);
      const text = await r.text();
      const parser = new DOMParser();
      const xml = parser.parseFromString(text, "application/xml");

      const outlines = xml.querySelectorAll("outline[xmlUrl]");
      if (!outlines.length) throw new Error("No feeds found in OPML.");

      let list = "<ul>";
      outlines.forEach(o => {
        const title = o.getAttribute("title") || o.getAttribute("text") || "Untitled";
        const url = o.getAttribute("xmlUrl");
        list += `<li><a href="${url}" target="_blank" rel="noopener noreferrer">${title}</a></li>`;
      });
      list += "</ul>";

      el.innerHTML = list;
    } catch (err) {
      console.error(err);
      el.innerHTML = "<p>⚠️ Could not load feed list.</p>";
    }
  });
})();
</script>

